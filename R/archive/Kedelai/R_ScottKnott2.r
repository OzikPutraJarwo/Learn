library(ScottKnott)
library(dplyr)

data_asli <- data.frame(

Genotipe = c("UBASK16", "UBASK13", "UBASK14", "UBASK12", "UBASK15", "UBASK61", "UBASK63", "UBASK64", "UBASK62", "UBASK65", "UBASK31", "UBASK36", "UBASK34", "UBASK32", "UBASK35", "UBASK41", "UBASK46", "UBASK43", "UBASK42", "UBASK45", "UBASK21", "UBASK26", "UBASK23", "UBASK24", "UBASK25", "UBASK51", "UBASK56", "UBASK53", "UBASK54", "UBASK52", "AJM", "AGP", "GBG", "TGM", "UB1", "UB2"),

PH = c(87.625, 76.2916666666667, 75.7916666666667, 72.4583333333333, 83.1666666666667, 82.125, 78.5, 82.25, 90.375, 56, 88.667, 77.833, 60.75, 89.083, 68.583, 65.917, 74, 81.417, 75.333, 76.583, 90.25, 91, 88.3333333333333, 82.75, 90.75, 87.1666666666667, 93.0833333333333, 97.9166666666667, 85.3333333333333, 95.1666666666667, 75, 74.083, 57.833, 92.1666666666667, 85.75, 78.0833333333333),

LN = c(0.75, 0.833333333333333, 1.08333333333333, 4.25, 3.66666666666667, 2.91666666666667, 1.91666666666667, 1.16666666666667, 1.83333333333333, 0.916666666666667, 1.75, 1, 1.583333, 2.25, 2.416667, 2.916667, 3.05, 2.75, 3.166667, 1, 12.3333333333333, 12.3333333333333, 11.75, 11.5, 13.1666666666667, 11.6666666666667, 12.8333333333333, 11.8333333333333, 10.5833333333333, 11.9166666666667, 1.66666666666667, 2.833333, 4, 12.25, 12.1666666666667, 2.5),

SD = c(0.543333333333333, 0.523333333333333, 0.5075, 0.531666666666667, 0.546666666666667, 0.575, 0.4575, 0.5625, 0.545, 0.583333333333333, 5.9, 5.425, 5.066667, 6.175, 4.841667, 5.233333, 6.141667, 4.9, 6.175, 6.05, 5.40833333333333, 6.175, 7.15, 6.48333333333333, 5.975, 6.1, 6.025, 5.71666666666667, 5.55833333333333, 5.48333333333333, 0.535, 5.35, 5.316667, 6.24166666666667, 5.98333333333333, 0.571666666666667),

BT = c(6.33333333333333, 6.33333333333333, 4.83333333333333, 9.41666666666667, 7.66666666666667, 8.83333333333333, 7.08333333333333, 7.75, 6.91666666666667, 5.33333333333333, 10.08, 10.33, 6.16, 10.5, 14.25, 9.75, 12.75, 7.08, 10.58, 10.83, 4.83333333333333, 7, 7.75, 5.66666666666667, 7.33333333333333, 4.16666666666667, 6.08333333333333, 6.83333333333333, 5.41666666666667, 5.41666666666667, 7.83333333333333, 10.5, 7, 9.75, 7.66666666666667, 7.33333333333333),

BP = c(4, 3.58333333333333, 2.75, 4.33333333333333, 4.25, 4.33333333333333, 2.33333333333333, 3.83333333333333, 3.91666666666667, 3.75, 2.916667, 4.25, 3.166667, 4.566667, 4.25, 4.5, 3.583333, 2.166667, 4.666667, 4.416667, 3.16666666666667, 4.58333333333333, 2.91666666666667, 3.08333333333333, 3.25, 2.83333333333333, 3.66666666666667, 3.33333333333333, 3.33333333333333, 3.25, 4.33333333333333, 2.583333, 3.416667, 4.83333333333333, 3.5, 4.08333333333333
),

NN = c(23.9166666666667, 24, 18.8333333333333, 27.9166666666667, 25.4166666666667, 23.6666666666667, 20.8333333333333, 22.5, 26.4166666666667, 25.75, 21, 29.08333, 20.16667, 23.08333, 28.33333, 25.25, 23.08333, 18.41667, 23.91667, 25.08333, 12.5833333333333, 21.6666666666667, 14.9166666666667, 11.3333333333333, 13.5, 13.5833333333333, 13.1666666666667, 12.1666666666667, 11.1666666666667, 13.3333333333333, 28.0833333333333, 20.33333, 19.5, 14.25, 12, 25.8333333333333),

ND = c(6.10018376049279, 5.60197789342336, 6.30647159657222, 6.07864671627353, 6.5702416512279, 7.16933661145618, 5.20709866278945, 6.81710428014597, 6.19894950952961, 5.26231137236039, 5.923333, 5.906667, 6.406667, 4.953333, 6.803333, 7.093333, 5.526667, 5.423333, 6.41, 6.666667, 6.34144096644097, 6.4004144004144, 5.82314768564769, 5.62602062289562, 5.69157578532579, 5.8151085026085, 6.1460816960817, 6.4003367003367, 6.13625841750842, 5.75981356606357, 5.76157750952594, 6.106667, 5.04, 4.83054029304029, 5.56793900543901, 7.05606088053631),

PNL = c(61.4166666666667, 56.9166666666667, 34.5833333333333, 71.25, 53.75, 49.5, 40.75, 46.6666666666667, 62.9166666666667, 38.4166666666667, 40.16667, 66.75, 37.66667, 51.25, 74.08333, 49.83333, 37.75, 32.83333, 51.66667, 68.41667, 59.3333333333333, 52.75, 62.4166666666667, 42.9166666666667, 73.75, 46.9166666666667, 59.5833333333333, 39.4166666666667, 56.8333333333333, 64.4166666666667, 58.1666666666667, 32.83333, 39.58333, 81.3333333333333, 54.3333333333333, 40.4166666666667),

PWL = c(23.7833333333333, 18.6, 18.5333333333333, 20.75, 21.025, 17, 15.9083333333333, 19.6, 23.3416666666667, 17.975, 24.33333, 22.63333, 25.34, 45.58333, 22.61333, 23.97333, 24.16667, 24.26, 19.08, 25.3, 12.9444427682224, 15.1749980560002, 13.7222205117779, 17.7305536517779, 14.7416646800002, 16.869442652889, 13.8555538064446, 10.7805542011112, 15.3805535891113, 19.2841651570001, 26.6833333333333, 27.08333, 21.445, 17.9833313106668, 16.1138868837779, 20.7916666666667),

PL = c(3.57791666666667, 3.5, 4.68041666666667, 3.41708333333333, 3.6375, 3.54875, 4.05875, 4.00041666666667, 3.49833333333333, 4.13916666666667, 40.98, 34.55667, 45.32667, 47.45667, 35.35333, 50.53333, 37.86667, 46.55667, 44.04667, 41.21, 39.1979166666667, 40.20625, 45.2575, 50.90375, 35.9095833333333, 42.21375, 37.93125, 41.0170833333333, 45.06, 37.7529166666667, 4.1815, 39.59, 50.28, 33.6966666666667, 42.1625, 4.41083333333333),

PW = c(0.927083333333333, 0.87625, 0.997916666666667, 0.970833333333333, 0.966666666666667, 0.998333333333333, 1.0255, 1.20291666666667, 0.92, 0.985, 8.883333, 8.136667, 10.063333, 9.623333, 7.896667, 9.266667, 7.293333, 9.18, 9.176667, 8.176667, 8.55208333333333, 9.19708333333333, 9.99416666666667, 11.0041666666667, 8.28, 9.47875, 8.22083333333333, 8.59458333333333, 8.72333333333333, 8.72083333333333, 1.101375, 8.13, 10.733333, 7.49666666666667, 8.97916666666667, 1.00416666666667),

PC = c(0.565166666666667, 0.536666666666667, 0.552666666666667, 0.548166666666667, 0.554083333333333, 0.525, 0.592583333333333, 0.539833333333333, 0.57675, 0.591, 5.623333, 4.72, 5.866667, 6.583333, 5.603333, 6.13, 4.586667, 6.113333, 4.863333, 5.406667, 4.92541666666667, 5.16666666666667, 5.61791666666667, 5.6625, 5.35166666666667, 5.18958333333333, 5.06666666666667, 5.33375, 5.61458333333333, 5.52916666666667, 0.585108333333333, 5.246667, 6.283333, 4.96291666666667, 5.65, 0.595083333333333),

SNP = c(2.27675772122506, 2.50359515547972, 2.9943023939727, 2.19864529347232, 2.30243161769482, 2.29577071854562, 2.91255395956694, 2.54428457768946, 2.2780304890377, 2.3642115085787, 2.45, 2.326667, 2.526667, 2.366667, 2.376667, 2.656667, 2.693333, 3.01, 2.76, 2.24, 2.36666666666667, 2.40833333333333, 2.59166666666667, 2.45, 2.43333333333333, 2.78333333333333, 2.61666666666667, 2.75833333333333, 2.81666666666667, 2.425, 2.41851077568521, 2.83, 2.263333, 2.325, 2.8, 2.6371570092925),

SNL = c(117.25, 113.416666666667, 94, 132.75, 98.5, 89.1666666666667, 84.1666666666667, 90.75, 117.166666666667, 89.1666666666667, 89.08333, 129.71667, 98.83333, 132.42333, 138.41667, 124.5, 83.13333, 85.75, 99.49667, 98.33333, 119.083333333333, 108.583333333333, 119.416666666667, 87.1666666666667, 140, 97.4166666666667, 127.583333333333, 87.6666666666667, 125.5, 122.25, 115.583333333333, 87.75, 70.66667, 156.666666666667, 123.5, 82.5833333333333),

SWL = c(14.8666666666667, 11.8833333333333, 12.1083333333333, 15.5916666666667, 13.0083333333333, 10.9, 9.525, 12.5, 15.7583333333333, 11.9583333333333, 25.08, 27.58, 31.32, 20.5, 38.19, 32.32, 15.17, 30.06, 35.21, 29.73, 10.4763880507778, 12.1499990280001, 10.6902769225556, 11.8986101592223, 12.4166656733334, 11.1972213264445, 10.931943569889, 8.46527710055561, 12.2902767945556, 13.344443376889, 18.1083333333333, 26.13, 27.21, 12.6416656553334, 12.531943441889, 13.7916666666667),

SL = c(0.705007555367338, 0.653729689339504, 0.686475935463004, 0.625993242868243, 0.742695928226363, 0.662749080581889, 0.669903395484375, 0.730129287046453, 0.711791093387289, 0.652444078144078, 7.173333, 6.47, 7.68, 8.273333, 6.766667, 7.85, 6.506667, 7.343333, 7.256667, 6.976667, 7.2875, 7.57208333333333, 8.00708333333333, 8.7875, 7.2825, 7.618125, 7.01833333333333, 6.5125, 7.37875, 7.27916666666667, 0.767617200854701, 6.426667, 8.686667, 6.4575, 7.3275, 0.757706730769231),

SW = c(0.463667900577683, 0.442549060724253, 0.469118585548496, 0.469234613816136, 0.465413553234205, 0.457309885674331, 0.526970268888032, 0.471891715495482, 0.486827145680406, 0.498598217841497, 5.873333, 5.03, 6.693333, 6.626667, 5.553333, 6.246667, 5.116667, 6.223333, 5.853333, 5.08, 5.77208333333333, 6.36666666666667, 6.47666666666667, 6.82333333333333, 5.67875, 6.30458333333333, 5.69375, 5.76166666666667, 6.25666666666667, 5.84375, 0.49161151855391, 5.76, 6.953333, 5.2625, 6.07666666666667, 0.516838762748689),

SC = c(0.567810663068815, 0.544658196621272, 0.576582588295451, 0.557121468775454, 0.575813801054018, 0.573166676737958, 0.577206187485116, 0.588687032568973, 0.568618979651588, 0.597096793488351, 4.673333, 4.29, 5.543333, 5.53, 4.673333, 4.766667, 4.363333, 5.283333, 4.513333, 4.3, 4.505, 4.91333333333333, 5.08583333333333, 5.37916666666667, 4.65, 5.02333333333333, 4.63416666666667, 4.87666666666667, 5.00041666666667, 4.68416666666667, 0.616201141370707, 5.016667, 5.583333, 4.16833333333333, 4.72583333333333, 0.584049659735689),

S100 = c(13.4666666666667, 10.3666666666667, 13.1, 12.1666666666667, 13.6666666666667, 11.2333333333333, 13.3, 12.5, 13.3666666666667, 13.8, 13.70667, 10.38, 18.66333, 21.16, 12.35, 17.46333, 13.30333, 17.47333, 14.54667, 11.93, 12.5333333333333, 14.6666666666667, 18.5333333333333, 17.5333333333333, 14.2, 17.2666666666667, 12.2, 13.7333333333333, 16.5666666666667, 14.3333333333333, 16.2333333333333, 14.9, 22.37, 9.73333333333333, 15.7333333333333, 15.3333333333333)

)

value <- "S100"

overall_sd <- sd(data_asli[[value]])
data_asli <- data_asli %>%
  mutate(rel_sd = .data[[value]] * 0.1)

set.seed(123)
data_simulasi <- data.frame(
  Perlakuan = rep(data_asli$Genotipe, each = 3),
  Ulangan = rep(1:3, times = nrow(data_asli)),
  Nilai = unlist(lapply(1:nrow(data_asli), function(i) {
    rnorm(3, mean = data_asli[[value]][i], sd = data_asli$rel_sd[i])
  }))
)

anova_model <- aov(Nilai ~ Perlakuan + Ulangan, data = data_simulasi)
summary(anova_model)
hasil <- SK(anova_model)
print(hasil$out$Result)